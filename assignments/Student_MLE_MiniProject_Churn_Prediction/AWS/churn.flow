{"metadata": {"version": 1, "disable_limits": false, "instance_type": "ml.m5.4xlarge", "disable_validation": true}, "parameters": [], "nodes": [{"node_id": "acf6f92a-8cc4-48a3-b995-68012947e492", "type": "SOURCE", "operator": "sagemaker.s3_source_0.1", "parameters": {"dataset_definition": {"datasetSourceType": "Local File Upload", "name": "storedata_total.csv", "description": null, "s3ExecutionContext": {"s3Uri": "s3://sagemaker-us-east-2-437799328129/Canvas/default-20251110T142968/uploads/storedata_total.csv", "s3ContentType": "csv", "s3HasHeader": true, "s3FieldDelimiter": ",", "s3DirIncludesNested": false, "s3AddsFilenameColumn": false, "s3RoleArn": null, "s3CsvEncodingType": "UTF_8", "s3SkipLines": 0, "s3MultiLine": false, "s3DataType": "S3Prefix", "s3ManifestPlain": {"s3Uris": null}}, "canvasDatasetMetadata": null}}, "inputs": [], "outputs": [{"name": "default", "sampling": {"sampling_method": "sample_by_count", "sample_size": 50000}}]}, {"node_id": "de130343-fc42-4ba3-ad15-fbef88fc4048", "type": "TRANSFORM", "operator": "sagemaker.spark.infer_and_cast_type_0.1", "parameters": {}, "trained_parameters": {"schema": {"custid": "string", "retained": "long", "created": "date", "firstorder": "datetime", "lastorder": "datetime", "esent": "long", "eopenrate": "float", "eclickrate": "float", "avgorder": "float", "ordfreq": "float", "paperless": "long", "refill": "long", "doorstep": "long", "favday": "string", "city": "string"}}, "inputs": [{"name": "default", "node_id": "acf6f92a-8cc4-48a3-b995-68012947e492", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "39c4c5bd-046b-4186-9cb4-69c4ba71854d", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "created", "original_data_type": "Date", "data_type": "datetime"}, "inputs": [{"name": "df", "node_id": "de130343-fc42-4ba3-ad15-fbef88fc4048", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "78fa3f4c-7b19-4b82-9b06-2c204b59fb0d", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "# Table is available as variable `df`\ndf['daysToFirstOrder'] = (df['firstorder'] - df['created']).dt.days"}, "pyspark_parameters": {"code": "# Table is available as variable `df`\ndf['daysToFirstOrder'] = (df['firstorder'] - df['created']).dt.days"}, "name": "daysToFirstOrder"}, "inputs": [{"name": "df", "node_id": "39c4c5bd-046b-4186-9cb4-69c4ba71854d", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "6a3268e6-70fb-4e96-b36f-479cf552ba23", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "# Table is available as variable `df`\ncustomerLifetimeDays = (df['lastorder'] - df['created']).dt.days\ndf['ordersPerDay'] = df['ordfreq'] / (customerLifetimeDays + 1)  # +1 to avoid division by zero\n"}, "pyspark_parameters": {}, "name": "ordersPerDay"}, "inputs": [{"name": "df", "node_id": "78fa3f4c-7b19-4b82-9b06-2c204b59fb0d", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "0b40651f-9e57-4e6f-8ddc-065a8d612e47", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "# Table is available as variable `df`\ndf['emailEngagementScore'] = (df['eopenrate'] * 0.6 + df['eclickrate'] * 0.4)"}, "pyspark_parameters": {}, "name": "emailEngagementScore"}, "inputs": [{"name": "df", "node_id": "6a3268e6-70fb-4e96-b36f-479cf552ba23", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "f53a7879-4512-4053-98ca-4655d044bcef", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "# Table is available as variable `df`\ndf['serviceAdoptionScore'] = df['paperless'] + df['refill'] + df['doorstep']\n"}, "pyspark_parameters": {}, "name": "serviceAdoptionScore"}, "inputs": [{"name": "df", "node_id": "0b40651f-9e57-4e6f-8ddc-065a8d612e47", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "ffe6b376-27f8-4421-806a-7a74308f2d49", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "# Table is available as variable `df`\nreference_date = df['lastorder'].max()  # Use max date as reference point\ndf['daysSinceLastOrder'] = (reference_date - df['lastorder']).dt.days"}, "pyspark_parameters": {"code": "# Table is available as variable `df`\nreference_date = df['lastorder'].max()  # Use max date as reference point\ndf['daysSinceLastOrder'] = (reference_date - df['lastorder']).dt.days"}, "name": "daysSinceLastOrder"}, "inputs": [{"name": "df", "node_id": "de130343-fc42-4ba3-ad15-fbef88fc4048", "output_name": "default"}], "outputs": [{"name": "default"}]}]}